openapi: 3.1.0
info:
  title: Links API (HATEOAS)
  version: 1.0.0
paths:
  /orders:
    post:
      operationId: createOrder
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderInput'
      responses:
        '201':
          description: Order created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
          links:
            GetOrder:
              $ref: '#/components/links/GetOrderById'
            GetOrderItems:
              $ref: '#/components/links/GetOrderItems'
            CancelOrder:
              $ref: '#/components/links/CancelOrder'
  /orders/{orderId}:
    get:
      operationId: getOrder
      parameters:
        - name: orderId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Order details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
          links:
            GetOrderItems:
              $ref: '#/components/links/GetOrderItems'
            GetCustomer:
              $ref: '#/components/links/GetCustomer'
            CancelOrder:
              $ref: '#/components/links/CancelOrder'
            GetPayment:
              $ref: '#/components/links/GetPayment'
    delete:
      operationId: cancelOrder
      parameters:
        - name: orderId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Order cancelled
          links:
            GetOrder:
              $ref: '#/components/links/GetOrderById'
  /orders/{orderId}/items:
    get:
      operationId: getOrderItems
      parameters:
        - name: orderId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Order items
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OrderItem'
          links:
            GetOrder:
              $ref: '#/components/links/GetOrderById'
  /customers/{customerId}:
    get:
      operationId: getCustomer
      parameters:
        - name: customerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Customer details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Customer'
          links:
            GetCustomerOrders:
              $ref: '#/components/links/GetCustomerOrders'
  /customers/{customerId}/orders:
    get:
      operationId: getCustomerOrders
      parameters:
        - name: customerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Customer orders
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Order'
  /payments/{paymentId}:
    get:
      operationId: getPayment
      parameters:
        - name: paymentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Payment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
          links:
            GetOrder:
              operationId: getOrder
              parameters:
                orderId: '$response.body#/orderId'
components:
  schemas:
    Order:
      type: object
      required:
        - id
        - customerId
        - status
        - total
      properties:
        id:
          type: string
          format: uuid
        customerId:
          type: string
          format: uuid
        paymentId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - pending
            - confirmed
            - shipped
            - delivered
            - cancelled
        total:
          type: number
          format: float64
        createdAt:
          type: string
          format: date-time
    OrderItem:
      type: object
      required:
        - id
        - productId
        - quantity
        - price
      properties:
        id:
          type: string
          format: uuid
        productId:
          type: string
          format: uuid
        productName:
          type: string
        quantity:
          type: integer
          format: int32
        price:
          type: number
          format: float64
    Customer:
      type: object
      required:
        - id
        - email
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        name:
          type: string
    Payment:
      type: object
      required:
        - id
        - orderId
        - amount
        - status
      properties:
        id:
          type: string
          format: uuid
        orderId:
          type: string
          format: uuid
        amount:
          type: number
          format: float64
        status:
          type: string
          enum:
            - pending
            - completed
            - failed
            - refunded
        method:
          type: string
          enum:
            - credit_card
            - debit_card
            - paypal
            - bank_transfer
    CreateOrderInput:
      type: object
      required:
        - customerId
        - items
      properties:
        customerId:
          type: string
          format: uuid
        items:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - productId
              - quantity
            properties:
              productId:
                type: string
                format: uuid
              quantity:
                type: integer
                minimum: 1
  links:
    GetOrderById:
      operationId: getOrder
      parameters:
        orderId: '$response.body#/id'
      description: Get the created/referenced order by ID
    GetOrderItems:
      operationId: getOrderItems
      parameters:
        orderId: '$response.body#/id'
      description: Get items for this order
    GetCustomer:
      operationId: getCustomer
      parameters:
        customerId: '$response.body#/customerId'
      description: Get customer who placed this order
    GetCustomerOrders:
      operationId: getCustomerOrders
      parameters:
        customerId: '$response.body#/id'
      description: Get all orders for this customer
    CancelOrder:
      operationId: cancelOrder
      parameters:
        orderId: '$response.body#/id'
      description: Cancel this order
    GetPayment:
      operationId: getPayment
      parameters:
        paymentId: '$response.body#/paymentId'
      description: Get payment details for this order
