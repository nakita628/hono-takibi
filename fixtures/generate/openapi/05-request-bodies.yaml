openapi: 3.1.0
info:
  title: Request Bodies API
  version: 1.0.0
paths:
  /users:
    post:
      operationId: createUser
      requestBody:
        $ref: '#/components/requestBodies/CreateUser'
      responses:
        '201':
          description: User created
  /users/{userId}:
    put:
      operationId: updateUser
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        $ref: '#/components/requestBodies/UpdateUser'
      responses:
        '200':
          description: User updated
    patch:
      operationId: patchUser
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        $ref: '#/components/requestBodies/PatchUser'
      responses:
        '200':
          description: User patched
  /users/{userId}/avatar:
    post:
      operationId: uploadAvatar
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        $ref: '#/components/requestBodies/FileUpload'
      responses:
        '200':
          description: Avatar uploaded
  /bulk/users:
    post:
      operationId: bulkCreateUsers
      requestBody:
        $ref: '#/components/requestBodies/BulkCreateUsers'
      responses:
        '201':
          description: Users created
components:
  schemas:
    User:
      type: object
      required:
        - id
        - email
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        name:
          type: string
        role:
          type: string
          enum:
            - admin
            - user
            - guest
    CreateUserInput:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
        name:
          type: string
        password:
          type: string
          format: binary
          minLength: 8
    UpdateUserInput:
      type: object
      required:
        - email
        - name
      properties:
        email:
          type: string
          format: email
        name:
          type: string
        role:
          type: string
          enum:
            - admin
            - user
            - guest
    PatchUserInput:
      type: object
      properties:
        email:
          type: string
          format: email
        name:
          type: string
        role:
          type: string
          enum:
            - admin
            - user
            - guest
  requestBodies:
    CreateUser:
      description: User creation request
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CreateUserInput'
          examples:
            basicUser:
              summary: Basic user creation
              value:
                email: user@example.com
                name: John Doe
                password: securePassword123
            minimalUser:
              summary: Minimal user creation
              value:
                email: minimal@example.com
    UpdateUser:
      description: Full user update request
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UpdateUserInput'
    PatchUser:
      description: Partial user update request
      required: false
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PatchUserInput'
        application/merge-patch+json:
          schema:
            $ref: '#/components/schemas/PatchUserInput'
    FileUpload:
      description: File upload request
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
              - file
            properties:
              file:
                type: string
                format: binary
              description:
                type: string
        image/png:
          schema:
            type: string
            format: binary
        image/jpeg:
          schema:
            type: string
            format: binary
    BulkCreateUsers:
      description: Bulk user creation request
      required: true
      content:
        application/json:
          schema:
            type: array
            minItems: 1
            maxItems: 100
            items:
              $ref: '#/components/schemas/CreateUserInput'
        application/x-ndjson:
          schema:
            $ref: '#/components/schemas/CreateUserInput'
