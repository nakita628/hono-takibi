openapi: 3.1.0
info:
  title: Headers API
  version: 1.0.0
paths:
  /resources:
    get:
      operationId: listResources
      parameters:
        - name: X-Request-ID
          in: header
          required: false
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of resources
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Resource'
  /resources/{id}:
    get:
      operationId: getResource
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: If-None-Match
          in: header
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Resource details
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Last-Modified:
              $ref: '#/components/headers/Last-Modified'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Resource'
        '304':
          description: Not modified
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
    put:
      operationId: updateResource
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: If-Match
          in: header
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Resource'
      responses:
        '200':
          description: Resource updated
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Resource'
        '412':
          description: Precondition failed
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
  /download/{id}:
    get:
      operationId: downloadFile
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: File download
          headers:
            Content-Disposition:
              $ref: '#/components/headers/Content-Disposition'
            Content-Length:
              $ref: '#/components/headers/Content-Length'
            X-Checksum-SHA256:
              $ref: '#/components/headers/X-Checksum-SHA256'
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
components:
  schemas:
    Resource:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        data:
          type: object
  headers:
    X-Request-ID:
      description: Unique request identifier for tracing
      required: true
      schema:
        type: string
        format: uuid
      example: 550e8400-e29b-41d4-a716-446655440000
    X-RateLimit-Limit:
      description: Maximum requests per time window
      required: true
      schema:
        type: integer
        format: int32
      example: 1000
    X-RateLimit-Remaining:
      description: Remaining requests in current window
      required: true
      schema:
        type: integer
        format: int32
      example: 999
    X-RateLimit-Reset:
      description: Unix timestamp when rate limit resets
      required: true
      schema:
        type: integer
        format: int64
      example: 1640995200
    ETag:
      description: Entity tag for cache validation
      required: true
      schema:
        type: string
      example: '"33a64df551425fcc55e4d42a148795d9f25f89d4"'
    Last-Modified:
      description: Last modification timestamp
      required: false
      schema:
        type: string
        format: date-time
      example: '2024-01-15T10:30:00Z'
    Cache-Control:
      description: Caching directives
      required: false
      schema:
        type: string
      example: 'max-age=3600, must-revalidate'
    Content-Disposition:
      description: Content disposition for downloads
      required: true
      schema:
        type: string
      example: 'attachment; filename="document.pdf"'
    Content-Length:
      description: Size in bytes
      required: true
      schema:
        type: integer
        format: int64
      example: 1048576
    X-Checksum-SHA256:
      description: SHA256 checksum of content
      required: false
      schema:
        type: string
      example: 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'
